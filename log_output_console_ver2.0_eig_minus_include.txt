* Initialize *
* Sampling *
* logarithmic distributions *
* Gradients *
* Sample mean *
* Update variational parameters *
* Care_lambda_muLambda *
* Care lambda_Lambda *
* Care lambda_nu *
* Care lambda_z *
* Care lambda_pi *
* sample_values for output *
* Session *
2017-12-15 10:30:02.605023: W c:\l\tensorflow_1501907206084\work\tensorflow-1.2.1\tensorflow\core\platform\cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE instructions, but these are available on your machine and could speed up CPU computations.
2017-12-15 10:30:02.605023: W c:\l\tensorflow_1501907206084\work\tensorflow-1.2.1\tensorflow\core\platform\cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE2 instructions, but these are available on your machine and could speed up CPU computations.
2017-12-15 10:30:02.605023: W c:\l\tensorflow_1501907206084\work\tensorflow-1.2.1\tensorflow\core\platform\cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE3 instructions, but these are available on your machine and could speed up CPU computations.
2017-12-15 10:30:02.605023: W c:\l\tensorflow_1501907206084\work\tensorflow-1.2.1\tensorflow\core\platform\cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.1 instructions, but these are available on your machine and could speed up CPU computations.
2017-12-15 10:30:02.605023: W c:\l\tensorflow_1501907206084\work\tensorflow-1.2.1\tensorflow\core\platform\cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.2 instructions, but these are available on your machine and could speed up CPU computations.
2017-12-15 10:30:02.605023: W c:\l\tensorflow_1501907206084\work\tensorflow-1.2.1\tensorflow\core\platform\cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX instructions, but these are available on your machine and could speed up CPU computations.
2017-12-15 10:30:02.605023: W c:\l\tensorflow_1501907206084\work\tensorflow-1.2.1\tensorflow\core\platform\cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX2 instructions, but these are available on your machine and could speed up CPU computations.
2017-12-15 10:30:02.605023: W c:\l\tensorflow_1501907206084\work\tensorflow-1.2.1\tensorflow\core\platform\cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use FMA instructions, but these are available on your machine and could speed up CPU computations.
[
sample_mu
array([[[ 0.60084236,  3.10443926],
        [ 1.17107224,  1.54651809],
        [-1.42340279,  1.42255402]],

       [[ 1.28943789,  0.49569589],
        [ 0.03931093,  0.34890187],
        [ 1.11453366,  0.89645219]]], dtype=float32), 
sample_Sigma
array([[[[  4.11759555e-01,  -1.63880721e-01],
         [ -1.63880736e-01,   1.52585399e+00]],

        [[  3.31578588e+00,  -5.24152613e+00],
         [ -5.24152565e+00,   1.49163427e+01]],

        [[  7.72637546e-01,  -1.07712939e-01],
         [ -1.07712932e-01,   1.07744384e+00]]],


       [[[  3.79280388e-01,  -2.80199246e-03],
         [ -2.80199246e-03,   2.25960538e-01]],

        [[  2.73012371e+01,   4.74357300e+01],
         [  4.74357338e+01,   8.68567963e+01]],

        [[  7.86049843e+00,   9.93467236e+00],
         [  9.93467140e+00,   1.30112829e+01]]]], dtype=float32), 
sample_z
array([[[1, 0, 0],
        [0, 0, 1],
        [1, 0, 0],
        [0, 0, 1],
        [0, 1, 0],
        [0, 0, 1],
        [0, 1, 0],
        [0, 0, 1],
        [0, 0, 1],
        [0, 0, 1]],

       [[0, 0, 1],
        [1, 0, 0],
        [0, 0, 1],
        [0, 1, 0],
        [0, 1, 0],
        [0, 1, 0],
        [0, 0, 1],
        [0, 1, 0],
        [0, 0, 1],
        [0, 0, 1]]]), 
sample_pi
array([[ 0.29235426,  0.66328669,  0.04435902],
       [ 0.22792405,  0.30427295,  0.46780303]], dtype=float32), 
lambda_mu_update
array([[ 20.72556496,   4.69556046],
       [ 28.53743935, -22.77516937],
       [ 30.06539917, -11.13481808]], dtype=float32), 
lambda_muLambda_cared
array([[[  9.99999975e-05,   0.00000000e+00],
        [  0.00000000e+00,   9.99999975e-05]],

       [[  9.99999975e-05,   0.00000000e+00],
        [  0.00000000e+00,   2.71550941e+01]],

       [[  9.99999975e-05,   0.00000000e+00],
        [  0.00000000e+00,   9.99999975e-05]]], dtype=float32), 
lambda_Lambda_cared
array([[[ 14.39226913,  -0.22934628],
        [ -0.22934631,  53.48991013]],

       [[  7.68701982, -13.48883152],
        [-13.48883152,  23.66999245]],

       [[  7.6524334 ,   1.75849009],
        [  1.75849032,   0.40419737]]], dtype=float32), 
lambda_nu_cared
array([  80.28487396,  101.90314484,   31.7294693 ], dtype=float32), 
lambda_z_cared
array([[ 0.33333331,  0.33333331,  0.33333331],
       [ 0.33333331,  0.33333331,  0.33333331],
       [ 0.33333331,  0.33333331,  0.33333331],
       [ 0.33333331,  0.33333331,  0.33333331],
       [ 0.33333334,  0.33333334,  0.33333334],
       [ 0.33333334,  0.33333334,  0.33333334],
       [ 0.33333334,  0.33333334,  0.33333334],
       [ 0.33333331,  0.33333331,  0.33333331],
       [ 0.33333331,  0.33333331,  0.33333331],
       [ 0.33333334,  0.33333334,  0.33333334]], dtype=float32), 
lambda_pi_cared
array([  5.47432947,   2.69450283,  11.16424561], dtype=float32), 
eig_val_lambda_Lambda
array([[ 14.3909235 ,  53.49125671],
       [-53.02791977,  31.3569088 ],
       [-21.93420982,   8.05653   ]], dtype=float32), 
lambda_Lambda_update
array([[[ 14.39226818,   0.22934628],
        [  0.22934628,  53.48990631]],

       [[-32.34152222,  36.3000145 ],
        [ 36.3000145 ,  10.67051411]],

       [[  6.55224371,   6.54612827],
        [  6.54612827, -20.42992592]]], dtype=float32), 
eig_val_lambda_muLambda
array([[-12.75118542, -12.18666077],
       [-14.86868477,  27.15509415],
       [-20.18300056,  -1.0005486 ]], dtype=float32), 
lambda_muLambda_update
array([[[-12.18666077,   0.        ],
        [  0.        , -12.75118542]],

       [[-14.86868572,   0.        ],
        [  0.        ,  27.15509415]],

       [[ -1.0005486 ,   0.        ],
        [  0.        , -20.18300056]]], dtype=float32), 
lambda_nu_update
array([  79.28487396,  100.90314484,  -30.7294693 ], dtype=float32), 
lambda_z_update
array([[  0.4303121 ,  18.89386749, -18.32417488],
       [ 15.69457245,   3.62960482, -18.32417488],
       [ 18.89386749, -22.85227776,   4.95841599],
       [ 18.89386749,   0.4303121 , -18.32417488],
       [ 18.89386749,  18.89386749, -36.78773117],
       [  1.75912344,  18.89386749, -19.65298462],
       [ 18.89386749,  18.89386749, -36.78773117],
       [ 15.69457245,   4.95841599, -19.65298462],
       [-18.32417488,   3.62960482,  15.69457245],
       [ 15.69457245, -10.30584621,  -4.3887248 ]], dtype=float32), 
lambda_pi_update
array([-10.94865894,  -5.38900566,  22.32849121], dtype=float32), 
grad_q_mu
[
array([[-0.39915764,  2.10443926],
       [ 0.17107224,  0.54651809],
       [-2.42340279,  0.42255402]], dtype=float32), 
array([[ 0.28943789, -0.50430411],
       [-0.96068907, -0.65109813],
       [ 0.11453366, -0.10354781]], dtype=float32), 
array([[-1.30091202, -0.50387567],
       [ 0.020136  , -0.09342098],
       [-0.1257121 , -0.04320282]], dtype=float32), 
array([[-0.46242726,  0.54604435],
       [-0.39294541,  2.52143288],
       [-1.45614684,  0.90380096]], dtype=float32)], 
grad_q_muLambda
[
array([[[ 0.4203366 ,  0.        ],
        [ 0.        , -1.71433234]],

       [[ 0.48536715, -0.        ],
        [-0.        ,  0.35065898]],

       [[-2.43644047,  0.        ],
        [ 0.        ,  0.41072404]]], dtype=float32), 
array([[[ 0.45811287,  0.        ],
        [ 0.        ,  0.37283868]],

       [[ 0.03853825, -0.        ],
        [-0.        ,  0.28803563]],

       [[ 0.49344102,  0.        ],
        [ 0.        ,  0.49463892]]], dtype=float32), 
array([[[-0.34618604, -0.        ],
        [-0.        ,  0.37305465]],

       [[ 0.49979728,  0.        ],
        [ 0.        ,  0.49563625]],

       [[ 0.49209824, -0.        ],
        [-0.        ,  0.49906677]]], dtype=float32), 
array([[[ 0.39308053,  0.        ],
        [ 0.        ,  0.35091779]],

       [[ 0.42279696,  0.        ],
        [ 0.        , -2.67881179]],

       [[-0.56018186,  0.        ],
        [ 0.        ,  0.0915719 ]]], dtype=float32)], 
grad_q_Lambda
[
array([[[ 0.26852572,  0.136243  ],
        [ 0.136243  , -0.51112962]],

       [[-0.34371954,  0.16580021],
        [ 0.16580021, -0.36618048]],

       [[ 1.05975604,  0.11623204],
        [ 0.11623204, -0.19078952]]], dtype=float32), 
array([[[ 0.31840682,  0.01634872],
        [ 0.01634872, -0.99432307]],

       [[ 0.818501  , -0.4409458 ],
        [-0.4409458 , -0.8930794 ]],

       [[-0.79057497, -0.47119913],
        [-0.47119913,  1.90835524]]], dtype=float32), 
array([[[-0.52384198, -0.1230494 ],
        [-0.1230494 , -0.93468112]],

       [[ 1.72588778, -1.39891553],
        [-1.39891553, -0.21773434]],

       [[ 1.53060365,  0.26621583],
        [ 0.26621583, -0.69026744]]], dtype=float32), 
array([[[-0.94106895,  0.04382006],
        [ 0.04382006, -0.96165961]],

       [[-0.56777513, -0.46314535],
        [-0.46314535,  1.00420403]],

       [[-0.7773537 ,  0.022465  ],
        [ 0.022465  , -0.83672261]]], dtype=float32)], 
grad_q_nu
[
array([ 1.01626754,  0.79759836,  1.52173972], dtype=float32), 
array([-1.1952796 , -5.2895112 ,  0.79576755], dtype=float32), 
array([-0.79844165,  0.40003043,  1.10118401], dtype=float32), 
array([-2.72403288,  1.05632639, -0.39386427], dtype=float32)], 
grad_q_z
[
array([[ 0.66666663, -0.33333334, -0.33333334],
       [ 0.66666663, -0.33333334, -0.33333334],
       [-0.33333334,  0.66666663, -0.33333334],
       [-0.33333334,  0.66666663, -0.33333334],
       [-0.33333334, -0.33333334,  0.66666663],
       [ 0.66666663, -0.33333334, -0.33333334],
       [-0.33333334, -0.33333334,  0.66666663],
       [ 0.66666663, -0.33333334, -0.33333334],
       [-0.33333334, -0.33333334,  0.66666663],
       [ 0.66666663, -0.33333334, -0.33333334]], dtype=float32), 
array([[-0.33333334, -0.33333334,  0.66666663],
       [-0.33333334, -0.33333334,  0.66666663],
       [-0.33333334,  0.66666663, -0.33333334],
       [-0.33333334, -0.33333334,  0.66666663],
       [-0.33333334, -0.33333334,  0.66666663],
       [-0.33333334, -0.33333334,  0.66666663],
       [-0.33333334, -0.33333334,  0.66666663],
       [-0.33333334, -0.33333334,  0.66666663],
       [ 0.66666663, -0.33333334, -0.33333334],
       [-0.33333334, -0.33333334,  0.66666663]], dtype=float32), 
array([[-0.33333334, -0.33333334,  0.66666663],
       [-0.33333334, -0.33333334,  0.66666663],
       [-0.33333334, -0.33333334,  0.66666663],
       [-0.33333334, -0.33333334,  0.66666663],
       [-0.33333334, -0.33333334,  0.66666663],
       [ 0.66666663, -0.33333334, -0.33333334],
       [-0.33333334, -0.33333334,  0.66666663],
       [-0.33333334,  0.66666663, -0.33333334],
       [ 0.66666663, -0.33333334, -0.33333334],
       [-0.33333334,  0.66666663, -0.33333334]], dtype=float32), 
array([[ 0.66666663, -0.33333334, -0.33333334],
       [-0.33333334,  0.66666663, -0.33333334],
       [-0.33333334,  0.66666663, -0.33333334],
       [-0.33333334,  0.66666663, -0.33333334],
       [-0.33333334, -0.33333334,  0.66666663],
       [-0.33333334, -0.33333334,  0.66666663],
       [-0.33333334, -0.33333334,  0.66666663],
       [-0.33333334, -0.33333334,  0.66666663],
       [-0.33333334,  0.66666663, -0.33333334],
       [-0.33333334,  0.66666663, -0.33333334]], dtype=float32)], 
grad_q_pi
[
array([ 0.68377113, -1.20187926,  0.09346604], dtype=float32), 
array([-0.06022429,  0.65881062, -0.68143249], dtype=float32), 
array([ 0.59864354, -0.29035115, -0.20790076], dtype=float32), 
array([ 0.3158282 ,  0.06168151, -0.05665588], dtype=float32)], 
log_loss
array([-127.97171021, -931.30371094, -557.41802979, -610.57049561], dtype=float32), 
log_p
array([-164.6999054 , -954.14520264, -586.93969727, -636.91064453], dtype=float32), 
log_q
array([-36.72819519, -22.84150887, -29.52164841, -26.34012985], dtype=float32), 
log_p_x
array([-120.5335083 , -921.04486084, -549.40838623, -604.73590088], dtype=float32), 
log_p_z
array([-11.83049107, -13.23583412, -11.76074314, -11.39252377], dtype=float32), 
log_p_pi
array([ 0.69314718,  0.69314718,  0.69314718,  0.69314718], dtype=float32), 
log_p_mu
array([-17.91556168, -14.0179882 , -13.00960922, -14.75592804], dtype=float32), 
log_p_Lambda
array([-15.11349297,  -6.53968668, -13.45416355,  -6.71947765], dtype=float32), 
log_q_z
array([-10.98612213, -10.98612213, -10.98612213, -10.98612213], dtype=float32), 
log_q_pi
array([ 0.36873436,  1.0523262 ,  1.41880178,  1.85972595], dtype=float32), 
log_q_mu
array([-10.99731636,  -6.36802578,  -6.50016403, -10.49425697], dtype=float32), 
log_q_Lambda
array([-15.11349297,  -6.53968668, -13.45416355,  -6.71947765], dtype=float32), 
sample_q_mu_ass
array([[[ 0.60084236,  3.10443926],
        [ 1.17107224,  1.54651809],
        [-1.42340279,  1.42255402]],

       [[ 1.28943789,  0.49569589],
        [ 0.03931093,  0.34890187],
        [ 1.11453366,  0.89645219]],

       [[-0.30091202,  0.49612433],
        [ 1.020136  ,  0.90657902],
        [ 0.8742879 ,  0.95679718]],

       [[ 0.53757274,  1.54604435],
        [ 0.60705459,  3.52143288],
        [-0.45614684,  1.90380096]]], dtype=float32), 
sample_q_Lambda_ass
array([[[[ 2.53705144,  0.272486  ],
         [ 0.272486  ,  0.97774082]],

        [[ 1.31256092,  0.33160043],
         [ 0.33160043,  1.26763904]],

        [[ 4.11951208,  0.23246408],
         [ 0.23246408,  1.61842096]]],


       [[[ 2.63681364,  0.03269744],
         [ 0.03269744,  0.01135385]],

        [[ 3.63700199, -0.88189161],
         [-0.88189161,  0.21384117]],

        [[ 0.41885009, -0.94239825],
         [-0.94239825,  5.81671047]]],


       [[[ 0.95231611, -0.2460988 ],
         [-0.2460988 ,  0.13063774]],

        [[ 5.45177555, -2.79783106],
         [-2.79783106,  1.56453133]],

        [[ 5.06120729,  0.53243166],
         [ 0.53243166,  0.61946511]]],


       [[[ 0.11786214,  0.08764011],
         [ 0.08764011,  0.07668079]],

        [[ 0.86444974, -0.92629069],
         [-0.92629069,  4.00840807]],

        [[ 0.44529262,  0.04493   ],
         [ 0.04493   ,  0.32655483]]]], dtype=float32), 
sample_q_z_ass
array([[[ 1.,  0.,  0.],
        [ 1.,  0.,  0.],
        [ 0.,  1.,  0.],
        [ 0.,  1.,  0.],
        [ 0.,  0.,  1.],
        [ 1.,  0.,  0.],
        [ 0.,  0.,  1.],
        [ 1.,  0.,  0.],
        [ 0.,  0.,  1.],
        [ 1.,  0.,  0.]],

       [[ 0.,  0.,  1.],
        [ 0.,  0.,  1.],
        [ 0.,  1.,  0.],
        [ 0.,  0.,  1.],
        [ 0.,  0.,  1.],
        [ 0.,  0.,  1.],
        [ 0.,  0.,  1.],
        [ 0.,  0.,  1.],
        [ 1.,  0.,  0.],
        [ 0.,  0.,  1.]],

       [[ 0.,  0.,  1.],
        [ 0.,  0.,  1.],
        [ 0.,  0.,  1.],
        [ 0.,  0.,  1.],
        [ 0.,  0.,  1.],
        [ 1.,  0.,  0.],
        [ 0.,  0.,  1.],
        [ 0.,  1.,  0.],
        [ 1.,  0.,  0.],
        [ 0.,  1.,  0.]],

       [[ 1.,  0.,  0.],
        [ 0.,  1.,  0.],
        [ 0.,  1.,  0.],
        [ 0.,  1.,  0.],
        [ 0.,  0.,  1.],
        [ 0.,  0.,  1.],
        [ 0.,  0.,  1.],
        [ 0.,  0.,  1.],
        [ 0.,  1.,  0.],
        [ 0.,  1.,  0.]]], dtype=float32), 
sample_q_pi_ass
array([[ 0.58620477,  0.08894507,  0.32485014],
       [ 0.27857125,  0.57175392,  0.14967488],
       [ 0.53836763,  0.2213061 ,  0.24032626],
       [ 0.40574557,  0.31468734,  0.27956706]], dtype=float32), 
delta_mu
array([[ 19.72556496,   3.69556046],
       [ 27.53743935, -23.77516937],
       [ 29.06539917, -12.13481808]], dtype=float32), 
delta_muLambda
array([[[-13.18666077,   0.        ],
        [  0.        , -13.75118542]],

       [[-15.86868572,   0.        ],
        [  0.        ,  26.15509415]],

       [[ -2.0005486 ,   0.        ],
        [  0.        , -21.18300056]]], dtype=float32), 
delta_Lambda
array([[[ 13.39226818,   0.22934628],
        [  0.22934628,  52.48990631]],

       [[-33.34152222,  36.3000145 ],
        [ 36.3000145 ,   9.67051411]],

       [[  5.55224371,   6.54612827],
        [  6.54612827, -21.42992592]]], dtype=float32), 
delta_nu
array([ 77.28487396,  98.90314484, -32.7294693 ], dtype=float32), 
delta_pi
array([-13.94865894,  -8.38900566,  19.32849121], dtype=float32), 
delta_z
array([[  0.09697876,  18.56053352, -18.65750885],
       [ 15.36123943,   3.29627156, -18.65750885],
       [ 18.56053352, -23.18561172,   4.62508249],
       [ 18.56053352,   0.09697876, -18.65750885],
       [ 18.56053352,  18.56053352, -37.12106323],
       [  1.42579007,  18.56053352, -19.98631859],
       [ 18.56053352,  18.56053352, -37.12106323],
       [ 15.36123943,   4.62508249, -19.98631859],
       [-18.65750885,   3.29627156,  15.36123943],
       [ 15.36123943, -10.63917923,  -4.7220583 ]], dtype=float32), 
eig_val_lambda_Lambda_modify
array([[  1.43909235e+01,   5.34912567e+01],
       [  9.99999975e-05,   3.13569088e+01],
       [  9.99999975e-05,   8.05653000e+00]], dtype=float32), 
diagonalized_Lambda
array([[[  1.43909235e+01,   0.00000000e+00],
        [  0.00000000e+00,   5.34912567e+01]],

       [[  9.99999975e-05,   0.00000000e+00],
        [  0.00000000e+00,   3.13569088e+01]],

       [[  9.99999975e-05,   0.00000000e+00],
        [  0.00000000e+00,   8.05653000e+00]]], dtype=float32), 
det_lambda_Lambda
array([  7.69788574e+02,   3.11307632e-03,   8.05736985e-04], dtype=float32), 
eig_val_lambda_Lambda_cared
array([[  1.43909245e+01,   5.34912605e+01],
       [  1.00183104e-04,   3.13569088e+01],
       [  9.99691329e-05,   8.05653095e+00]], dtype=float32), 
eig_val_lambda_muLambda_modify
array([[  9.99999975e-05,   9.99999975e-05],
       [  9.99999975e-05,   2.71550941e+01],
       [  9.99999975e-05,   9.99999975e-05]], dtype=float32), 
diagonalized_muLambda
array([[[  9.99999975e-05,   0.00000000e+00],
        [  0.00000000e+00,   9.99999975e-05]],

       [[  9.99999975e-05,   0.00000000e+00],
        [  0.00000000e+00,   2.71550941e+01]],

       [[  9.99999975e-05,   0.00000000e+00],
        [  0.00000000e+00,   9.99999975e-05]]], dtype=float32)]
1
[
sample_mu
array([[[ 212.79652405,  -28.4809227 ],
        [ -22.88901329,  -22.9508152 ],
        [ 181.12472534,   24.5195694 ]],

       [[-165.09675598,   21.2554493 ],
        [  13.63419628,  -22.75678825],
        [  82.66731262,   38.64415359]]], dtype=float32), 
sample_Sigma
array([[[[  6.82963291e-04,  -2.76308019e-05],
         [ -2.76308019e-05,   2.27186625e-04]],

        [[  7.05009079e+01,   4.01568642e+01],
         [  4.01568642e+01,   2.28734722e+01]],

        [[  1.95064335e+01,  -8.46478271e+01],
         [ -8.46478195e+01,   3.67405731e+02]]],


       [[[  1.00583653e-03,  -3.30436596e-05],
         [ -3.30436633e-05,   1.66116864e-04]],

        [[  7.30265579e+01,   4.15837555e+01],
         [  4.15837555e+01,   2.36795559e+01]],

        [[  2.07487888e+01,  -9.02617264e+01],
         [ -9.02617264e+01,   3.92725098e+02]]]], dtype=float32), 
sample_z
array([[[0, 0, 1],
        [0, 0, 1],
        [0, 1, 0],
        [0, 1, 0],
        [0, 1, 0],
        [0, 0, 1],
        [1, 0, 0],
        [1, 0, 0],
        [1, 0, 0],
        [0, 0, 1]],

       [[0, 0, 1],
        [1, 0, 0],
        [0, 0, 1],
        [1, 0, 0],
        [0, 1, 0],
        [1, 0, 0],
        [0, 0, 1],
        [0, 0, 1],
        [0, 1, 0],
        [0, 1, 0]]]), 
sample_pi
array([[ 0.2900449 ,  0.07714346,  0.63281161],
       [ 0.29661006,  0.0584951 ,  0.64489484]], dtype=float32), 
lambda_mu_update
array([[   49.40359497,    11.58328629],
       [    8.06540298,  4897.47802734],
       [   26.88996696,   -20.94044876]], dtype=float32), 
lambda_muLambda_cared
array([[[  9.99999975e-05,   0.00000000e+00],
        [  0.00000000e+00,   1.29524630e+07]],

       [[  2.86100731e+01,   0.00000000e+00],
        [  0.00000000e+00,   8.34967300e+06]],

       [[  9.99999975e-05,   0.00000000e+00],
        [  0.00000000e+00,   9.99999975e-05]]], dtype=float32), 
lambda_Lambda_cared
array([[[  5.21784592e+01,   9.72775040e+01],
        [  9.72775116e+01,   1.81357132e+02]],

       [[  8.88350000e+07,   5.05068240e+07],
        [  5.05068280e+07,   2.87161320e+07]],

       [[  5.76318562e+05,   2.56154775e+06],
        [  2.56154775e+06,   1.13858720e+07]]], dtype=float32), 
lambda_nu_cared
array([  79.03528595,  431.44241333,   67.4015274 ], dtype=float32), 
lambda_z_cared
array([[ 0.33333331,  0.33333331,  0.33333331],
       [ 0.33333331,  0.33333331,  0.33333331],
       [ 0.33333331,  0.33333331,  0.33333331],
       [ 0.33333331,  0.33333331,  0.33333331],
       [ 0.33333334,  0.33333334,  0.33333334],
       [ 0.33333331,  0.33333331,  0.33333331],
       [ 0.33333331,  0.33333331,  0.33333331],
       [ 0.33333334,  0.33333334,  0.33333334],
       [ 0.33333334,  0.33333334,  0.33333334],
       [ 0.33333331,  0.33333331,  0.33333331]], dtype=float32), 
lambda_pi_cared
array([  73.95085144,  198.82748413,   64.37197876], dtype=float32), 
eig_val_lambda_Lambda
array([[ -2.83582611e+02,   2.33535507e+02],
       [  4.97832428e+02,   1.17550640e+08],
       [  3.02537575e+01,   1.19621600e+07]], dtype=float32), 
lambda_Lambda_update
array([[[ -1.68043900e+02,  -2.15401871e+02],
        [ -2.15401871e+02,   1.17996796e+02]],

       [[  8.88350000e+07,   5.05068240e+07],
        [  5.05068240e+07,   2.87161360e+07]],

       [[  5.76318500e+05,  -2.56154750e+06],
        [ -2.56154750e+06,   1.13858710e+07]]], dtype=float32), 
eig_val_lambda_muLambda
array([[ -2.24217450e+06,   1.29524630e+07],
       [  2.86100731e+01,   8.34967300e+06],
       [ -7.41635850e+06,  -5.50964150e+06]], dtype=float32), 
lambda_muLambda_update
array([[[  1.29524630e+07,   0.00000000e+00],
        [  0.00000000e+00,  -2.24217450e+06]],

       [[  8.34967300e+06,   0.00000000e+00],
        [  0.00000000e+00,   2.86100731e+01]],

       [[ -7.41635850e+06,   0.00000000e+00],
        [  0.00000000e+00,  -5.50964150e+06]]], dtype=float32), 
lambda_nu_update
array([  79.03528595,  431.44241333,   67.4015274 ], dtype=float32), 
lambda_z_update
array([[-275.53128052,  681.92474365, -405.39334106],
       [-275.53128052,  -52.50375366,  329.03518677],
       [-275.53128052,  -13.11432362,  289.64569092],
       [ -52.50375366,  681.92474365, -628.42089844],
       [ 339.77529907, -628.42089844,  289.64569092],
       [-275.53128052,  329.03518677,  -52.50375366],
       [-275.53128052,  329.03518677,  -52.50375366],
       [-667.81036377,  681.92474365,  -13.11432362],
       [ 681.92474365, -628.42089844,  -52.50375366],
       [ -52.50375366,  681.92474365, -628.42089844]], dtype=float32), 
lambda_pi_update
array([-147.90170288, -397.65496826,  128.74395752], dtype=float32), 
grad_q_mu
[
array([[-0.00855269, -0.00220423],
       [ 0.00721496,  0.53705448],
       [-0.00726929,  0.01141326]], dtype=float32), 
array([[ -1.23980409e-02,  -2.03901660e-02],
       [ -7.38348532e-03,   6.73729038e+00],
       [  9.06323828e-03,   2.34004965e-05]], dtype=float32), 
array([[ -6.74681645e-03,   5.12739224e-03],
       [  9.29354411e-03,  -5.15015984e+00],
       [  4.70481487e-03,  -2.22118548e-03]], dtype=float32), 
array([[ -1.95622109e-02,  -9.91629669e-04],
       [  1.77170876e-02,  -5.70389223e+00],
       [  6.46185246e-04,   7.06419628e-03]], dtype=float32)], 
grad_q_muLambda
[
array([[[  1.34257300e+03,  -0.00000000e+00],
        [ -0.00000000e+00,   4.75706885e+03]],

       [[  2.39721753e+03,  -0.00000000e+00],
        [ -0.00000000e+00,   1.82171818e-02]],

       [[  2.35786841e+03,   0.00000000e+00],
        [  0.00000000e+00,  -1.51312158e+03]]], dtype=float32), 
array([[[ -2.68557153e+03,  -0.00000000e+00],
        [ -0.00000000e+00,  -1.57879443e+04]],

       [[  2.27420728e+03,   0.00000000e+00],
        [  0.00000000e+00,  -1.23650720e-02]],

       [[  8.92885498e+02,  -0.00000000e+00],
        [ -0.00000000e+00,   4.99997266e+03]]], dtype=float32), 
array([[[  2.72402319e+03,   0.00000000e+00],
        [  0.00000000e+00,   3.68549219e+03]],

       [[  6.81501770e+02,   0.00000000e+00],
        [  0.00000000e+00,   4.27820720e-04]],

       [[  3.89323560e+03,   0.00000000e+00],
        [  0.00000000e+00,   4.75331689e+03]]], dtype=float32), 
array([[[ -1.41340068e+04,  -0.00000000e+00],
        [ -0.00000000e+00,   4.95083350e+03]],

       [[ -1.06947598e+04,   0.00000000e+00],
        [  0.00000000e+00,  -3.64747527e-03]],

       [[  4.97912207e+03,  -0.00000000e+00],
        [ -0.00000000e+00,   2.50485620e+03]]], dtype=float32)], 
grad_q_Lambda
[
array([[[ -2.22605810e-01,   8.74658525e-02],
        [  8.74658525e-02,  -7.50858039e-02]],

       [[  1.21834977e+05,   6.95851719e+04],
        [  6.95851719e+04,   3.97426719e+04]],

       [[  2.14789014e+03,  -9.31227832e+03],
        [ -9.31227832e+03,   4.03655195e+04]]], dtype=float32), 
array([[[ -1.66735470e-01,   3.04533094e-01],
        [  3.04533094e-01,  -1.10156015e-01]],

       [[ -2.23312344e+04,  -1.26323984e+04],
        [ -1.26323984e+04,  -7.14568408e+03]],

       [[  2.93348885e+01,  -1.67373047e+02],
        [ -1.67373047e+02,   8.96571289e+02]]], dtype=float32), 
array([[[  3.12508643e-01,   2.15625405e-01],
        [  2.15625405e-01,  -1.18771441e-01]],

       [[ -9.57300547e+04,  -5.44466953e+04],
        [ -5.44466953e+04,  -3.09668418e+04]],

       [[  1.37057510e+02,  -5.37223145e+02],
        [ -5.37223145e+02,   2.07541553e+03]]], dtype=float32), 
array([[[  2.03507245e-01,  -7.10816402e-03],
        [ -7.10816402e-03,   4.87209223e-02]],

       [[ -8.88682109e+04,  -5.06542539e+04],
        [ -5.06542539e+04,  -2.88731406e+04]],

       [[ -1.43643884e+03,   6.28493164e+03],
        [  6.28493164e+03,  -2.74972871e+04]]], dtype=float32)], 
grad_q_nu
[
array([-0.07826233,  0.09041023,  0.05519938], dtype=float32), 
array([-0.12204409, -0.05545425, -0.01395822], dtype=float32), 
array([-0.02754784, -0.2061286 , -0.01588011], dtype=float32), 
array([ 0.08554077, -0.27159882, -0.04533195], dtype=float32)], 
grad_q_z
[
array([[-0.33333334, -0.33333334,  0.66666663],
       [-0.33333334,  0.66666663, -0.33333334],
       [-0.33333334,  0.66666663, -0.33333334],
       [ 0.66666663, -0.33333334, -0.33333334],
       [ 0.66666663, -0.33333334, -0.33333334],
       [-0.33333334, -0.33333334,  0.66666663],
       [-0.33333334, -0.33333334,  0.66666663],
       [-0.33333334, -0.33333334,  0.66666663],
       [-0.33333334, -0.33333334,  0.66666663],
       [ 0.66666663, -0.33333334, -0.33333334]], dtype=float32), 
array([[-0.33333334, -0.33333334,  0.66666663],
       [-0.33333334, -0.33333334,  0.66666663],
       [-0.33333334,  0.66666663, -0.33333334],
       [-0.33333334, -0.33333334,  0.66666663],
       [-0.33333334,  0.66666663, -0.33333334],
       [-0.33333334,  0.66666663, -0.33333334],
       [-0.33333334,  0.66666663, -0.33333334],
       [-0.33333334, -0.33333334,  0.66666663],
       [-0.33333334,  0.66666663, -0.33333334],
       [-0.33333334, -0.33333334,  0.66666663]], dtype=float32), 
array([[-0.33333334, -0.33333334,  0.66666663],
       [-0.33333334,  0.66666663, -0.33333334],
       [-0.33333334, -0.33333334,  0.66666663],
       [ 0.66666663, -0.33333334, -0.33333334],
       [-0.33333334, -0.33333334,  0.66666663],
       [-0.33333334, -0.33333334,  0.66666663],
       [-0.33333334, -0.33333334,  0.66666663],
       [ 0.66666663, -0.33333334, -0.33333334],
       [-0.33333334, -0.33333334,  0.66666663],
       [ 0.66666663, -0.33333334, -0.33333334]], dtype=float32), 
array([[ 0.66666663, -0.33333334, -0.33333334],
       [ 0.66666663, -0.33333334, -0.33333334],
       [ 0.66666663, -0.33333334, -0.33333334],
       [-0.33333334, -0.33333334,  0.66666663],
       [-0.33333334,  0.66666663, -0.33333334],
       [ 0.66666663, -0.33333334, -0.33333334],
       [ 0.66666663, -0.33333334, -0.33333334],
       [ 0.66666663, -0.33333334, -0.33333334],
       [-0.33333334,  0.66666663, -0.33333334],
       [-0.33333334, -0.33333334,  0.66666663]], dtype=float32)], 
grad_q_pi
[
array([-0.91342378, -0.36715746,  0.36082554], dtype=float32), 
array([ 0.28207517,  0.44076133, -0.19362187], dtype=float32), 
array([ 0.2814858 ,  0.26388454, -0.13171673], dtype=float32), 
array([ 0.26731372,  0.27877593, -0.1264174 ], dtype=float32)], 
log_loss
array([-13685.97851562, -14115.58398438, -15691.16308594, -38298.2421875 ], dtype=float32), 
log_p
array([-13749.02148438, -14178.43261719, -15752.17578125, -38361.09375   ], dtype=float32), 
log_q
array([-63.04261398, -62.84903717, -61.0125351 , -62.85177231], dtype=float32), 
log_p_x
array([-323.33831787, -183.83711243, -423.49658203, -149.80343628], dtype=float32), 
log_p_z
array([-11.71954441, -11.29539871, -11.71142387, -11.44472313], dtype=float32), 
log_p_pi
array([ 0.69314718,  0.69314718,  0.69314718,  0.69314718], dtype=float32), 
log_p_mu
array([ -9386.55859375,  -9997.90039062, -11351.17675781, -33976.3984375 ], dtype=float32), 
log_p_Lambda
array([-4028.09863281, -3986.0925293 , -3966.484375  , -4224.13916016], dtype=float32), 
log_q_z
array([-10.98612213, -10.98612213, -10.98612213, -10.98612213], dtype=float32), 
log_q_pi
array([ 1.13328171,  2.21582031,  2.54268456,  2.55836964], dtype=float32), 
log_q_mu
array([-28.45985031, -31.25511932, -28.30332565, -31.22714424], dtype=float32), 
log_q_Lambda
array([-24.72992325, -22.82361603, -24.26576996, -23.19687653], dtype=float32), 
sample_q_mu_ass
array([[[ -64.80136108,  -17.34673119],
        [ 100.68704224,  -22.75539207],
        [ -42.62754059,  102.99774933]],

       [[-103.25485992, -199.20611572],
        [ -45.29741669,  -22.52706528],
        [ 120.69778442,  -10.9008131 ]],

       [[ -46.74260712,   55.96948624],
        [ 121.47288513,  -22.96482658],
        [  77.11354828,  -33.34667587]],

       [[-174.89656067,   -5.2207365 ],
        [ 205.70832825,  -22.98521805],
        [  36.5272522 ,   59.50714874]]], dtype=float32), 
sample_q_Lambda_ass
array([[[[ 1062.09863281,   119.57761383],
         [  119.57761383,  3860.44873047]],

        [[  708.75897217, -1244.65649414],
         [-1244.65649414,  2185.80297852]],

        [[  194.97158813,    44.74470901],
         [   44.74470901,    10.27283478]]],


       [[[ 1082.37475586,   454.30664062],
         [  454.30664062,  3649.11962891]],

        [[  730.46875   , -1282.3770752 ],
         [-1282.3770752 ,  2251.3203125 ]],

        [[  214.23182678,    49.29163742],
         [   49.29163742,    11.34463215]]],


       [[[ 1282.08630371,   314.45529175],
         [  314.45529175,  3604.23193359]],

        [[  683.08502197, -1199.31787109],
         [-1199.31787109,  2105.71777344]],

        [[  213.40992737,    48.94339371],
         [   48.94339371,    11.22800922]]],


       [[[ 1239.8885498 ,   -31.89697075],
         [  -31.89697075,  4573.59814453]],

        [[  573.99438477, -1007.15032959],
         [-1007.15032959,  1767.21264648]],

        [[  247.30241394,    56.77439117],
         [   56.77439117,    13.03668499]]]], dtype=float32), 
sample_q_z_ass
array([[[ 0.,  0.,  1.],
        [ 0.,  1.,  0.],
        [ 0.,  1.,  0.],
        [ 1.,  0.,  0.],
        [ 1.,  0.,  0.],
        [ 0.,  0.,  1.],
        [ 0.,  0.,  1.],
        [ 0.,  0.,  1.],
        [ 0.,  0.,  1.],
        [ 1.,  0.,  0.]],

       [[ 0.,  0.,  1.],
        [ 0.,  0.,  1.],
        [ 0.,  1.,  0.],
        [ 0.,  0.,  1.],
        [ 0.,  1.,  0.],
        [ 0.,  1.,  0.],
        [ 0.,  1.,  0.],
        [ 0.,  0.,  1.],
        [ 0.,  1.,  0.],
        [ 0.,  0.,  1.]],

       [[ 0.,  0.,  1.],
        [ 0.,  1.,  0.],
        [ 0.,  0.,  1.],
        [ 1.,  0.,  0.],
        [ 0.,  0.,  1.],
        [ 0.,  0.,  1.],
        [ 0.,  0.,  1.],
        [ 1.,  0.,  0.],
        [ 0.,  0.,  1.],
        [ 1.,  0.,  0.]],

       [[ 1.,  0.,  0.],
        [ 1.,  0.,  0.],
        [ 1.,  0.,  0.],
        [ 0.,  0.,  1.],
        [ 0.,  1.,  0.],
        [ 1.,  0.,  0.],
        [ 1.,  0.,  0.],
        [ 1.,  0.,  0.],
        [ 0.,  1.,  0.],
        [ 0.,  0.,  1.]]], dtype=float32), 
sample_q_pi_ass
array([[ 0.10611913,  0.08138473,  0.81249619],
       [ 0.35074559,  0.18256505,  0.46668941],
       [ 0.350539  ,  0.15296814,  0.4964928 ],
       [ 0.34560612,  0.15526311,  0.49913082]], dtype=float32), 
delta_mu
array([[  2.86780300e+01,   6.88772583e+00],
       [ -2.04720364e+01,   4.92025342e+03],
       [ -3.17543197e+00,  -9.80563068e+00]], dtype=float32), 
delta_muLambda
array([[[  1.29524630e+07,   0.00000000e+00],
        [  0.00000000e+00,  -2.24217450e+06]],

       [[  8.34967300e+06,   0.00000000e+00],
        [  0.00000000e+00,   1.45497835e+00]],

       [[ -7.41635850e+06,   0.00000000e+00],
        [  0.00000000e+00,  -5.50964150e+06]]], dtype=float32), 
delta_Lambda
array([[[ -1.82436172e+02,  -2.15172531e+02],
        [ -2.15172531e+02,   6.45068893e+01]],

       [[  8.88349920e+07,   5.05068360e+07],
        [  5.05068360e+07,   2.87161120e+07]],

       [[  5.76310875e+05,  -2.56154925e+06],
        [ -2.56154925e+06,   1.13858710e+07]]], dtype=float32), 
delta_nu
array([  -1.24959111,  329.53927612,   35.67205811], dtype=float32), 
delta_pi
array([-153.3760376 , -400.34945679,  117.57970428], dtype=float32), 
delta_z
array([[-275.86462402,  681.59143066, -405.72668457],
       [-275.86462402,  -52.83708572,  328.70184326],
       [-275.86462402,  -13.44765663,  289.31234741],
       [ -52.83708572,  681.59143066, -628.75421143],
       [ 339.44195557, -628.75421143,  289.31234741],
       [-275.86462402,  328.70184326,  -52.83708572],
       [-275.86462402,  328.70184326,  -52.83708572],
       [-668.14367676,  681.59143066,  -13.44765663],
       [ 681.59143066, -628.75421143,  -52.83708572],
       [ -52.83708572,  681.59143066, -628.75421143]], dtype=float32), 
eig_val_lambda_Lambda_modify
array([[  9.99999975e-05,   2.33535507e+02],
       [  4.97832428e+02,   1.17550640e+08],
       [  3.02537575e+01,   1.19621600e+07]], dtype=float32), 
diagonalized_Lambda
array([[[  9.99999975e-05,   0.00000000e+00],
        [  0.00000000e+00,   2.33535507e+02]],

       [[  4.97832428e+02,   0.00000000e+00],
        [  0.00000000e+00,   1.17550640e+08]],

       [[  3.02537575e+01,   0.00000000e+00],
        [  0.00000000e+00,   1.19621600e+07]]], dtype=float32), 
det_lambda_Lambda
array([  2.22650561e-02,   5.82757581e+10,   3.62459008e+08], dtype=float32), 
eig_val_lambda_Lambda_cared
array([[  8.93276519e-05,   2.33535507e+02],
       [  4.95530945e+02,   1.17550640e+08],
       [  3.02951393e+01,   1.19621610e+07]], dtype=float32), 
eig_val_lambda_muLambda_modify
array([[  9.99999975e-05,   1.29524630e+07],
       [  2.86100731e+01,   8.34967300e+06],
       [  9.99999975e-05,   9.99999975e-05]], dtype=float32), 
diagonalized_muLambda
array([[[  9.99999975e-05,   0.00000000e+00],
        [  0.00000000e+00,   1.29524630e+07]],

       [[  2.86100731e+01,   0.00000000e+00],
        [  0.00000000e+00,   8.34967300e+06]],

       [[  9.99999975e-05,   0.00000000e+00],
        [  0.00000000e+00,   9.99999975e-05]]], dtype=float32)]
2
[
sample_mu
array([[[  -36.12332916,    11.58322525],
        [    8.20029163,  4897.47802734],
        [  -45.80297089,    93.19212341]],

       [[  -74.576828  ,    11.5827198 ],
        [    7.92736387,  4897.47851562],
        [  117.52235413,   -20.70644379]]], dtype=float32), 
sample_Sigma
array([[[[  1.00487663e+02,  -5.38947411e+01],
         [ -5.38947372e+01,   2.89055443e+01]],

        [[  1.25163569e-06,  -2.20233824e-06],
         [ -2.20233824e-06,   3.87524824e-06]],

        [[  5.61003166e-04,  -1.26262632e-04],
         [ -1.26262632e-04,   2.84188791e-05]]],


       [[[  9.79347458e+01,  -5.25128212e+01],
         [ -5.25128212e+01,   2.81575623e+01]],

        [[  1.11489487e-06,  -1.96140945e-06],
         [ -1.96140945e-06,   3.45075091e-06]],

        [[  7.03575381e-04,  -1.58227849e-04],
         [ -1.58227849e-04,   3.55854609e-05]]]], dtype=float32), 
sample_z
array([[[0, 0, 1],
        [0, 1, 0],
        [0, 0, 1],
        [0, 0, 1],
        [0, 1, 0],
        [0, 0, 1],
        [1, 0, 0],
        [0, 0, 1],
        [1, 0, 0],
        [0, 1, 0]],

       [[0, 0, 1],
        [0, 1, 0],
        [1, 0, 0],
        [0, 1, 0],
        [0, 0, 1],
        [0, 1, 0],
        [1, 0, 0],
        [0, 1, 0],
        [0, 0, 1],
        [0, 1, 0]]]), 
sample_pi
array([[ 0.19039743,  0.62023318,  0.1893694 ],
       [ 0.20927128,  0.60509229,  0.18563637]], dtype=float32), 
lambda_mu_update
array([[  1.53311930e+07,   1.03184020e+13],
       [ -1.11416545e+10,   4.89747803e+03],
       [ -2.77541225e+06,  -1.48806100e+06]], dtype=float32), 
lambda_muLambda_cared
array([[[  1.29525440e+07,   0.00000000e+00],
        [  0.00000000e+00,   1.97039594e+13]],

       [[  8.34952200e+06,   0.00000000e+00],
        [  0.00000000e+00,   5.31495880e+07]],

       [[  9.99999975e-05,   0.00000000e+00],
        [  0.00000000e+00,   7.87529387e+12]]], dtype=float32), 
lambda_Lambda_cared
array([[[  1.10524801e+14,  -5.93596525e+13],
        [ -5.93596525e+13,   3.18803406e+13]],

       [[  1.00283976e+08,   3.04229440e+07],
        [  3.04229420e+07,   6.39476200e+07]],

       [[  5.69830562e+05,  -2.54804500e+06],
        [ -2.54804475e+06,   1.13937950e+07]]], dtype=float32), 
lambda_nu_cared
array([  1.54442720e+08,   7.51360080e+07,   7.96807600e+07], dtype=float32), 
lambda_z_cared
array([[ 0.33333334,  0.33333334,  0.33333334],
       [ 0.33333331,  0.33333331,  0.33333331],
       [ 0.33333334,  0.33333334,  0.33333334],
       [ 0.33333331,  0.33333331,  0.33333331],
       [ 0.33333334,  0.33333334,  0.33333334],
       [ 0.33333334,  0.33333334,  0.33333334],
       [ 0.33333331,  0.33333331,  0.33333331],
       [ 0.33333331,  0.33333331,  0.33333331],
       [ 0.33333334,  0.33333334,  0.33333334],
       [ 0.33333331,  0.33333331,  0.33333331]], dtype=float32), 
lambda_pi_cared
array([  1.58902870e+07,   2.77503220e+07,   1.00824840e+08], dtype=float32), 
eig_val_lambda_Lambda
array([[ -4.86337480e+07,   1.42405144e+14],
       [  4.66808120e+07,   1.17550784e+08],
       [ -5.36408576e+08,   1.19636250e+07]], dtype=float32), 
lambda_Lambda_update
array([[[  1.10524767e+14,  -5.93596567e+13],
        [ -5.93596567e+13,   3.18803007e+13]],

       [[  1.00283968e+08,   3.04229380e+07],
        [  3.04229420e+07,   6.39476120e+07]],

       [[ -5.10289408e+08,   1.16793760e+08],
        [  1.16793760e+08,  -1.41554780e+07]]], dtype=float32), 
eig_val_lambda_muLambda
array([[  1.29525440e+07,   1.97039594e+13],
       [  8.34952200e+06,   5.31495880e+07],
       [ -9.71452816e+12,   7.87529387e+12]], dtype=float32), 
lambda_muLambda_update
array([[[  1.97039594e+13,   0.00000000e+00],
        [  0.00000000e+00,   1.29525440e+07]],

       [[  5.31495880e+07,   0.00000000e+00],
        [  0.00000000e+00,   8.34952200e+06]],

       [[ -9.71452816e+12,   0.00000000e+00],
        [  0.00000000e+00,   7.87529387e+12]]], dtype=float32), 
lambda_nu_update
array([  1.54442720e+08,   7.51360080e+07,  -7.96807600e+07], dtype=float32), 
lambda_z_update
array([[  8.40530368e+08,  -4.35245632e+08,  -4.05284672e+08],
       [  2.04546400e+08,   2.00299376e+08,  -4.04845632e+08],
       [  8.40530368e+08,  -4.09531648e+08,  -4.30998592e+08],
       [ -4.05284672e+08,   2.00299376e+08,   2.04985392e+08],
       [  2.30699376e+08,  -4.35245632e+08,   2.04546400e+08],
       [  2.04546400e+08,   8.40530368e+08,  -1.04507661e+09],
       [ -4.30998592e+08,   2.00299376e+08,   2.30699376e+08],
       [  2.00299376e+08,   2.04546400e+08,  -4.04845632e+08],
       [  8.40530368e+08,  -4.05284672e+08,  -4.35245632e+08],
       [  2.00299376e+08,   2.04546400e+08,  -4.04845632e+08]], dtype=float32), 
lambda_pi_update
array([  3.17805740e+07,   5.55006440e+07,  -2.01649680e+08], dtype=float32), 
grad_q_mu
[
array([[  1.97517574e-02,  -6.04033936e+03],
       [  3.06336141e+00,  -0.00000000e+00],
       [  7.21721631e-03,  -6.45747548e-03]], dtype=float32), 
array([[ -1.78626981e-02,  -4.00218774e+03],
       [  9.90226841e+00,  -0.00000000e+00],
       [ -4.10263380e-03,  -1.62596293e-02]], dtype=float32), 
array([[ -1.44036375e-02,  -6.57149365e+03],
       [  1.04829140e+01,  -0.00000000e+00],
       [ -2.62930407e-03,   8.26338865e-03]], dtype=float32), 
array([[ -1.07177384e-02,   1.35876755e+02],
       [ -5.75812054e+00,  -0.00000000e+00],
       [  4.14601481e-03,   1.64239444e-02]], dtype=float32)], 
grad_q_muLambda
[
array([[[ -1.45065967e+04,   0.00000000e+00],
        [  0.00000000e+00,  -7.01369487e-08]],

       [[  1.17440680e-02,  -0.00000000e+00],
        [ -0.00000000e+00,   5.98825878e-08]],

       [[  2.39558936e+03,   0.00000000e+00],
        [  0.00000000e+00,   2.91505029e+03]]], dtype=float32), 
array([[[ -1.09537998e+04,  -0.00000000e+00],
        [ -0.00000000e+00,  -9.13485820e-09]],

       [[ -4.24201414e-02,  -0.00000000e+00],
        [ -0.00000000e+00,   5.98825878e-08]],

       [[  4.15841943e+03,  -0.00000000e+00],
        [ -0.00000000e+00,  -8.21877734e+03]]], dtype=float32), 
array([[[ -5.37323877e+03,  -0.00000000e+00],
        [ -0.00000000e+00,  -9.01017145e-08]],

       [[ -4.96504717e-02,  -0.00000000e+00],
        [ -0.00000000e+00,   5.98825878e-08]],

       [[  4.65433789e+03,   0.00000000e+00],
        [  0.00000000e+00,   1.58582031e+03]]], dtype=float32), 
array([[[ -7.43496216e+02,   0.00000000e+00],
        [  0.00000000e+00,   3.85476717e-08]],

       [[ -2.77683465e-03,  -0.00000000e+00],
        [ -0.00000000e+00,   5.98825878e-08]],

       [[  4.14052783e+03,  -0.00000000e+00],
        [ -0.00000000e+00,  -8.48729688e+03]]], dtype=float32)], 
grad_q_Lambda
[
array([[[ -2.21477129e+04,   1.19354102e+04],
        [  1.19354102e+04,  -6.43179639e+03]],

       [[ -8.83429404e-03,   1.55262826e-02],
        [  1.55262826e-02,  -2.72878334e-02]],

       [[ -2.11978823e-01,   4.77211997e-02],
        [  4.77211997e-02,  -1.07435547e-02]]], dtype=float32), 
array([[[ -3.81539453e+04,   2.04982500e+04],
        [  2.04982500e+04,  -1.10126865e+04]],

       [[ -1.02124764e-02,   1.78927481e-02],
        [  1.78927481e-02,  -3.13485786e-02]],

       [[ -6.05841689e-02,   1.37634650e-02],
        [  1.37634650e-02,  -3.12646176e-03]]], dtype=float32), 
array([[[ -5.23232383e+04,   2.80795176e+04],
        [  2.80795176e+04,  -1.50690352e+04]],

       [[  5.48005570e-04,  -9.49417125e-04],
        [ -9.49417125e-04,   1.64439157e-03]],

       [[  3.34150761e-01,  -7.47909322e-02],
        [ -7.47909322e-02,   1.67392399e-02]]], dtype=float32), 
array([[[ -6.16954258e+04,   3.31110391e+04],
        [  3.31110391e+04,  -1.77702227e+04]],

       [[  1.33002264e-04,  -2.50892714e-04],
        [ -2.50892714e-04,   4.71080013e-04]],

       [[  7.28330374e-01,  -1.63307354e-01],
        [ -1.63307354e-01,   3.66163813e-02]]], dtype=float32)], 
grad_q_nu
[
array([ 0.08918667, -0.06617498, -0.17054129], dtype=float32), 
array([-0.06674194, -0.05622816, -0.00714827], dtype=float32), 
array([ -1.42062187e-01,  -5.10215759e-05,   8.24646950e-02], dtype=float32), 
array([-0.11885977,  0.00158167,  0.21213961], dtype=float32)], 
grad_q_z
[
array([[-0.33333334, -0.33333334,  0.66666663],
       [-0.33333334, -0.33333334,  0.66666663],
       [-0.33333334,  0.66666663, -0.33333334],
       [ 0.66666663, -0.33333334, -0.33333334],
       [ 0.66666663, -0.33333334, -0.33333334],
       [-0.33333334, -0.33333334,  0.66666663],
       [-0.33333334, -0.33333334,  0.66666663],
       [-0.33333334, -0.33333334,  0.66666663],
       [-0.33333334,  0.66666663, -0.33333334],
       [-0.33333334, -0.33333334,  0.66666663]], dtype=float32), 
array([[-0.33333334, -0.33333334,  0.66666663],
       [ 0.66666663, -0.33333334, -0.33333334],
       [-0.33333334, -0.33333334,  0.66666663],
       [ 0.66666663, -0.33333334, -0.33333334],
       [-0.33333334, -0.33333334,  0.66666663],
       [ 0.66666663, -0.33333334, -0.33333334],
       [ 0.66666663, -0.33333334, -0.33333334],
       [-0.33333334,  0.66666663, -0.33333334],
       [-0.33333334,  0.66666663, -0.33333334],
       [-0.33333334,  0.66666663, -0.33333334]], dtype=float32), 
array([[-0.33333334,  0.66666663, -0.33333334],
       [-0.33333334, -0.33333334,  0.66666663],
       [-0.33333334, -0.33333334,  0.66666663],
       [-0.33333334, -0.33333334,  0.66666663],
       [-0.33333334,  0.66666663, -0.33333334],
       [-0.33333334, -0.33333334,  0.66666663],
       [ 0.66666663, -0.33333334, -0.33333334],
       [-0.33333334, -0.33333334,  0.66666663],
       [-0.33333334, -0.33333334,  0.66666663],
       [-0.33333334, -0.33333334,  0.66666663]], dtype=float32), 
array([[-0.33333334,  0.66666663, -0.33333334],
       [-0.33333334,  0.66666663, -0.33333334],
       [-0.33333334,  0.66666663, -0.33333334],
       [-0.33333334,  0.66666663, -0.33333334],
       [-0.33333334,  0.66666663, -0.33333334],
       [-0.33333334, -0.33333334,  0.66666663],
       [-0.33333334,  0.66666663, -0.33333334],
       [ 0.66666663, -0.33333334, -0.33333334],
       [-0.33333334, -0.33333334,  0.66666663],
       [ 0.66666663, -0.33333334, -0.33333334]], dtype=float32)], 
grad_q_pi
[
array([ 0.14075565, -0.0371089 , -0.04610872], dtype=float32), 
array([ 0.02404499, -0.02818394,  0.07133389], dtype=float32), 
array([-0.22528505,  0.02889681,  0.14545107], dtype=float32), 
array([ 0.01603937, -0.05202961,  0.14363623], dtype=float32)], 
log_loss
array([ -2.43932426e+10,  -2.54393610e+10,  -2.54218015e+10,
        -2.56092406e+10], dtype=float32), 
log_p
array([ -2.43932426e+10,  -2.54393610e+10,  -2.54218015e+10,
        -2.56092406e+10], dtype=float32), 
log_q
array([-109.54173279, -108.8556366 , -111.33283997, -112.73329163], dtype=float32), 
log_p_x
array([-661.22924805, -507.88656616, -894.43920898, -990.41192627], dtype=float32), 
log_p_z
array([-11.98808861, -11.0075264 , -11.93223763, -10.35595798], dtype=float32), 
log_p_pi
array([ 0.69314718,  0.69314718,  0.69314718,  0.69314718], dtype=float32), 
log_p_mu
array([-1074028.625, -1073161.75 , -1066978.625, -1073130.25 ], dtype=float32), 
log_p_Lambda
array([ -2.43921674e+10,  -2.54382879e+10,  -2.54207345e+10,
        -2.56081674e+10], dtype=float32), 
log_q_z
array([-10.98612213, -10.98612213, -10.98612213, -10.98612213], dtype=float32), 
log_q_pi
array([ 4.84576416,  5.5397644 ,  3.34002686,  4.82040405], dtype=float32), 
log_q_mu
array([-5.487041  , -6.82837486, -6.49584866, -4.08418274], dtype=float32), 
log_q_Lambda
array([ -97.91433716,  -96.5809021 ,  -97.19089508, -102.48339081], dtype=float32), 
sample_q_mu_ass
array([[[  2.46921173e+02,   1.15828199e+01],
        [  8.17247581e+00,   4.89747803e+03],
        [  9.90621338e+01,  -8.55151978e+01]],

       [[ -1.29223389e+02,   1.15829773e+01],
        [  8.41151428e+00,   4.89747803e+03],
        [ -1.41363735e+01,  -1.83536743e+02]],

       [[ -9.46327820e+01,   1.15827789e+01],
        [  8.43180943e+00,   4.89747803e+03],
        [  5.96923828e-01,   6.16934395e+01]],

       [[ -5.77737961e+01,   1.15832968e+01],
        [  7.86414099e+00,   4.89747803e+03],
        [  6.83501205e+01,   1.43298996e+02]]], dtype=float32), 
sample_q_Lambda_ass
array([[[[  5.27260205e+03,   9.82744727e+03],
         [  9.82744727e+03,   1.83171172e+04]],

        [[  3.63474780e+10,   2.06666056e+10],
         [  2.06666056e+10,   1.17509652e+10]],

        [[  3.30534160e+07,   1.46889568e+08],
         [  1.46889568e+08,   6.52811968e+08]]],


       [[[  3.99310474e+03,   7.44302051e+03],
         [  7.44302051e+03,   1.38735830e+04]],

        [[  3.78283295e+10,   2.15152292e+10],
         [  2.15152292e+10,   1.22372485e+10]],

        [[  3.91130960e+07,   1.73748608e+08],
         [  1.73748608e+08,   7.71867648e+08]]],


       [[[  3.55736011e+03,   6.63146533e+03],
         [  6.63146533e+03,   1.23620967e+04]],

        [[  3.78790666e+10,   2.15343309e+10],
         [  2.15343309e+10,   1.22425948e+10]],

        [[  3.47988160e+07,   1.54385808e+08],
         [  1.54385808e+08,   6.84989888e+08]]],


       [[[  3.86434277e+03,   7.20359277e+03],
         [  7.20359277e+03,   1.34283770e+04]],

        [[  3.81411369e+10,   2.16869724e+10],
         [  2.16869724e+10,   1.23314493e+10]],

        [[  3.60042320e+07,   1.59620736e+08],
         [  1.59620736e+08,   7.07727616e+08]]]], dtype=float32), 
sample_q_z_ass
array([[[ 0.,  0.,  1.],
        [ 0.,  0.,  1.],
        [ 0.,  1.,  0.],
        [ 1.,  0.,  0.],
        [ 1.,  0.,  0.],
        [ 0.,  0.,  1.],
        [ 0.,  0.,  1.],
        [ 0.,  0.,  1.],
        [ 0.,  1.,  0.],
        [ 0.,  0.,  1.]],

       [[ 0.,  0.,  1.],
        [ 1.,  0.,  0.],
        [ 0.,  0.,  1.],
        [ 1.,  0.,  0.],
        [ 0.,  0.,  1.],
        [ 1.,  0.,  0.],
        [ 1.,  0.,  0.],
        [ 0.,  1.,  0.],
        [ 0.,  1.,  0.],
        [ 0.,  1.,  0.]],

       [[ 0.,  1.,  0.],
        [ 0.,  0.,  1.],
        [ 0.,  0.,  1.],
        [ 0.,  0.,  1.],
        [ 0.,  1.,  0.],
        [ 0.,  0.,  1.],
        [ 1.,  0.,  0.],
        [ 0.,  0.,  1.],
        [ 0.,  0.,  1.],
        [ 0.,  0.,  1.]],

       [[ 0.,  1.,  0.],
        [ 0.,  1.,  0.],
        [ 0.,  1.,  0.],
        [ 0.,  1.,  0.],
        [ 0.,  1.,  0.],
        [ 0.,  0.,  1.],
        [ 0.,  1.,  0.],
        [ 1.,  0.,  0.],
        [ 0.,  0.,  1.],
        [ 1.,  0.,  0.]]], dtype=float32), 
sample_q_pi_ass
array([[ 0.25115994,  0.56765974,  0.18118031],
       [ 0.22349285,  0.57274866,  0.20375851],
       [ 0.17417307,  0.60639268,  0.21943426],
       [ 0.22171082,  0.55925274,  0.21903636]], dtype=float32), 
delta_mu
array([[  1.53311440e+07,   1.03184020e+13],
       [ -1.11416545e+10,   0.00000000e+00],
       [ -2.77543925e+06,  -1.48804000e+06]], dtype=float32), 
delta_muLambda
array([[[  1.97039594e+13,   0.00000000e+00],
        [  0.00000000e+00,   8.11655960e+01]],

       [[  5.31495600e+07,   0.00000000e+00],
        [  0.00000000e+00,  -1.50999420e+02]],

       [[ -9.71452816e+12,   0.00000000e+00],
        [  0.00000000e+00,   7.87529387e+12]]], dtype=float32), 
delta_Lambda
array([[[  1.10524767e+14,  -5.93596567e+13],
        [ -5.93596567e+13,   3.18803007e+13]],

       [[  1.14489640e+07,  -2.00838860e+07],
        [ -2.00838860e+07,   3.52314800e+07]],

       [[ -5.10865728e+08,   1.14232216e+08],
        [  1.14232216e+08,  -2.55413500e+07]]], dtype=float32), 
delta_nu
array([  1.54442640e+08,   7.51355760e+07,  -7.96808240e+07], dtype=float32), 
delta_pi
array([  3.17805000e+07,   5.55004440e+07,  -2.01649744e+08], dtype=float32), 
delta_z
array([[  8.40530368e+08,  -4.35245632e+08,  -4.05284672e+08],
       [  2.04546400e+08,   2.00299376e+08,  -4.04845632e+08],
       [  8.40530368e+08,  -4.09531648e+08,  -4.30998592e+08],
       [ -4.05284672e+08,   2.00299376e+08,   2.04985392e+08],
       [  2.30699376e+08,  -4.35245632e+08,   2.04546400e+08],
       [  2.04546400e+08,   8.40530368e+08,  -1.04507661e+09],
       [ -4.30998592e+08,   2.00299376e+08,   2.30699376e+08],
       [  2.00299376e+08,   2.04546400e+08,  -4.04845632e+08],
       [  8.40530368e+08,  -4.05284672e+08,  -4.35245632e+08],
       [  2.00299376e+08,   2.04546400e+08,  -4.04845632e+08]], dtype=float32), 
eig_val_lambda_Lambda_modify
array([[  9.99999975e-05,   1.42405144e+14],
       [  4.66808120e+07,   1.17550784e+08],
       [  9.99999975e-05,   1.19636250e+07]], dtype=float32), 
diagonalized_Lambda
array([[[  9.99999975e-05,   0.00000000e+00],
        [  0.00000000e+00,   1.42405144e+14]],

       [[  4.66808120e+07,   0.00000000e+00],
        [  0.00000000e+00,   1.17550784e+08]],

       [[  9.99999975e-05,   0.00000000e+00],
        [  0.00000000e+00,   1.19636250e+07]]], dtype=float32), 
det_lambda_Lambda
array([  0.00000000e+00,   5.48736564e+15,   0.00000000e+00], dtype=float32), 
eig_val_lambda_Lambda_cared
array([[ -2.90186300e+06,   1.42405160e+14],
       [  4.66808160e+07,   1.17550792e+08],
       [ -0.00000000e+00,   1.19636250e+07]], dtype=float32), 
eig_val_lambda_muLambda_modify
array([[  1.29525440e+07,   1.97039594e+13],
       [  8.34952200e+06,   5.31495880e+07],
       [  9.99999975e-05,   7.87529387e+12]], dtype=float32), 
diagonalized_muLambda
array([[[  1.29525440e+07,   0.00000000e+00],
        [  0.00000000e+00,   1.97039594e+13]],

       [[  8.34952200e+06,   0.00000000e+00],
        [  0.00000000e+00,   5.31495880e+07]],

       [[  9.99999975e-05,   0.00000000e+00],
        [  0.00000000e+00,   7.87529387e+12]]], dtype=float32)]
3
Traceback (most recent call last):
  File "C:\Users\2016-020\Anaconda3.4.64\envs\tfenv\lib\site-packages\tensorflow\python\client\session.py", line 1139, in _do_call
    return fn(*args)
  File "C:\Users\2016-020\Anaconda3.4.64\envs\tfenv\lib\site-packages\tensorflow\python\client\session.py", line 1121, in _run_fn
    status, run_metadata)
  File "C:\Users\2016-020\Anaconda3.4.64\envs\tfenv\lib\contextlib.py", line 66, in __exit__
    next(self.gen)
  File "C:\Users\2016-020\Anaconda3.4.64\envs\tfenv\lib\site-packages\tensorflow\python\framework\errors_impl.py", line 466, in raise_exception_on_not_ok_status
    pywrap_tensorflow.TF_GetCode(status))
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: Prepare_for_output/sample_Sigma = MatrixInverse[T=DT_FLOAT, adjoint=false, _device="/job:localhost/replica:0/task:0/cpu:0"](ApproximatedDistributions/q_Lambda/sample_2/Reshape_2)]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:/Users/2016-020/PycharmProjects/BasicBBVI2dGMM/Basic_BBVI_for_2d_GMM_ver2.0.py", line 384, in <module>
    delta_pi, delta_z, eig_val_lambda_Lambda_modify, diagonalized_Lambda, det_lambda_Lambda, eig_val_lambda_Lambda_cared, eig_val_lambda_muLambda_modify, diagonalized_muLambda], feed_dict={X: x})  # for plot test
  File "C:\Users\2016-020\Anaconda3.4.64\envs\tfenv\lib\site-packages\tensorflow\python\client\session.py", line 789, in run
    run_metadata_ptr)
  File "C:\Users\2016-020\Anaconda3.4.64\envs\tfenv\lib\site-packages\tensorflow\python\client\session.py", line 997, in _run
    feed_dict_string, options, run_metadata)
  File "C:\Users\2016-020\Anaconda3.4.64\envs\tfenv\lib\site-packages\tensorflow\python\client\session.py", line 1132, in _do_run
    target_list, options, run_metadata)
  File "C:\Users\2016-020\Anaconda3.4.64\envs\tfenv\lib\site-packages\tensorflow\python\client\session.py", line 1152, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Input is not invertible.
	 [[Node: Prepare_for_output/sample_Sigma = MatrixInverse[T=DT_FLOAT, adjoint=false, _device="/job:localhost/replica:0/task:0/cpu:0"](ApproximatedDistributions/q_Lambda/sample_2/Reshape_2)]]

Caused by op 'Prepare_for_output/sample_Sigma', defined at:
  File "C:/Users/2016-020/PycharmProjects/BasicBBVI2dGMM/Basic_BBVI_for_2d_GMM_ver2.0.py", line 334, in <module>
    sample_Sigma = tf.matrix_inverse( q_Lambda.sample( sample_shape=[num_samples], seed=0 ), name='sample_Sigma' )
  File "C:\Users\2016-020\Anaconda3.4.64\envs\tfenv\lib\site-packages\tensorflow\python\ops\gen_linalg_ops.py", line 307, in matrix_inverse
    name=name)
  File "C:\Users\2016-020\Anaconda3.4.64\envs\tfenv\lib\site-packages\tensorflow\python\framework\op_def_library.py", line 767, in apply_op
    op_def=op_def)
  File "C:\Users\2016-020\Anaconda3.4.64\envs\tfenv\lib\site-packages\tensorflow\python\framework\ops.py", line 2506, in create_op
    original_op=self._default_original_op, op_def=op_def)
  File "C:\Users\2016-020\Anaconda3.4.64\envs\tfenv\lib\site-packages\tensorflow\python\framework\ops.py", line 1269, in __init__
    self._traceback = _extract_stack()

InvalidArgumentError (see above for traceback): Input is not invertible.
	 [[Node: Prepare_for_output/sample_Sigma = MatrixInverse[T=DT_FLOAT, adjoint=false, _device="/job:localhost/replica:0/task:0/cpu:0"](ApproximatedDistributions/q_Lambda/sample_2/Reshape_2)]]

